(this.webpackJsonphotm=this.webpackJsonphotm||[]).push([[1],{299:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(12),r=a.n(n),i=a(6),o=a(0),l=a.n(o),c=a(29),s=a(83),m=a(323),d=Object(c.a)((function(){return{stripe:{marginTop:20,marginBottom:20}}}));var u=Object(m.injectStripe)((function(e){var t=e.loggedIn,a=e.stripe,n=e.handleCharge,c=e.payMessage,u=Object(o.useState)(""),g=Object(i.a)(u,2),p=g[0],b=g[1],f=d();return l.a.createElement("div",{className:f.stripe},l.a.createElement("form",{onSubmit:function(e){var t;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.preventDefault(),!a){i.next=8;break}return i.next=4,r.a.awrap(a.createToken());case 4:(t=i.sent).token?n(t.token):alert("Payment token creation failed"),i.next=9;break;case 8:console.log("Stripe.js hasn't loaded yet.");case 9:case"end":return i.stop()}}))}},l.a.createElement("label",null,"Card details",l.a.createElement(m.CardElement,Object.assign({onChange:function(e){var t=e.error;t&&b(t.message)}},{hidePostalCode:!0,style:{base:{letterSpacing:"0.025em","::placeholder":{color:"#aab7c4"}},invalid:{color:"#c23d4b"}}}))),l.a.createElement("div",{className:f.stripe,role:"alert"},p),l.a.createElement(s.a,{variant:"contained",color:"primary",fullWidth:!0,type:"submit",disabled:!t},c)))}));function g(e){var t=e.stripePublicKey,a=e.handleCharge,n=e.loggedIn,r=e.payMessage;return l.a.createElement(m.StripeProvider,{apiKey:t},l.a.createElement(m.Elements,null,l.a.createElement(u,{handleCharge:a,loggedIn:n,payMessage:r})))}},310:function(e,t,a){"use strict";var n=a(32),r=a(8),i=a(6),o=a(0),l=a.n(o),c=a(29),s=a(83),m=a(362),d=a(493),u=a(494),g=a(257),p=a(496),b=a(118),f=a(20),E=a(259),y=a(501),k=a(26),v=a(486),h=a(487),O=a(491),j=a(489),w=a(488),x=a(155),S=a(157),B=a(314),C=a.n(B),_=a(313),A=a.n(_),P=a(315),N=a.n(P),D=a(316),F=a.n(D),I=a(107),M=a.n(I),T=a(317),z=a.n(T),Q=a(318),Y=a.n(Q),R=a(492),H=a(490),U=Object(c.a)((function(e){return{paper:{width:"100%",overflowX:"auto"},background:{backgroundColor:e.palette.primary.main},priceField:Object(k.a)({display:"none"},e.breakpoints.up("sm"),{display:"inline"}),priceEmbedded:Object(k.a)({display:"inline"},e.breakpoints.up("sm"),{display:"none"})}}));var W=Object(n.b)((function(e){return{itemQty:e.itemQty}}),(function(e){return{incItemQty:function(t){return e(Object(r.E)(t))},decItemQty:function(t){return e(Object(r.C)(t))}}}))((function(e){var t=e.theme,a=e.items,n=e.cat,r=e.organic,c=e.pensioner,m=e.itemQty,d=e.incItemQty,u=e.decItemQty,g=e.artistBooking,p=U(t),b=Object(o.useState)(!1),f=Object(i.a)(b,2),E=f[0],y=f[1];return l.a.createElement(x.a,{className:p.paper},l.a.createElement(v.a,{size:"small","aria-label":"a dense table"},l.a.createElement(h.a,{className:p.background},l.a.createElement(w.a,null,l.a.createElement(j.a,{align:"left",style:{width:"60%"}},n.name.toUpperCase(),l.a.createElement(S.a,{onClick:function(e){y(!E)},edge:"start"},E?l.a.createElement(A.a,null):l.a.createElement(C.a,null))),l.a.createElement(j.a,{align:"right",style:{width:"30%",padding:0}},l.a.createElement("div",{className:p.priceField},l.a.createElement(N.a,{fontSize:"small",color:"inherit"}))),l.a.createElement(j.a,{align:"right",style:{width:"10%"}},l.a.createElement(S.a,{color:"inherit"},l.a.createElement(H.a,{badgeContent:function(e,t){var a=0,n=!0,r=!1,i=void 0;try{for(var o,l=e.list[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var c=o.value;a+=t[c]?t[c]:0}}catch(s){r=!0,i=s}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return a}(n,m),showZero:!0},l.a.createElement(F.a,null)))))),E?l.a.createElement(O.a,null,n.list.map((function(e){return l.a.createElement(w.a,{key:e},l.a.createElement(j.a,{align:"left",style:{width:"60%"}},a[e].description+(a[e].addOn?"*":""),l.a.createElement("div",{className:p.priceEmbedded}," - $".concat(((r?a[e].organicPrice:a[e].price)*(c?.8:1)).toFixed(2)))),l.a.createElement(j.a,{align:"right",style:{width:"30%",padding:0}},l.a.createElement("div",{className:p.priceField},((r?a[e].organicPrice:a[e].price)*(c?.8:1)).toFixed(2))),a[e].onlineBooking||g?l.a.createElement(j.a,{align:"right",style:{width:"10%"}},l.a.createElement(R.a,null,l.a.createElement(s.a,{variant:"text",startIcon:l.a.createElement(M.a,{fontSize:"small"}),onClick:function(){return d(e)}},m[e]?m[e]:0),l.a.createElement(S.a,{onClick:function(){return u(e)}},l.a.createElement(z.a,{fontSize:"small"})))):l.a.createElement(j.a,{align:"center",style:{width:"10%"}},l.a.createElement(Y.a,null)))}))):null))})),L=a(255),$=a(254),G=a(268),K=a(211),V=a(320),q=a.n(V),J=a(319),X=a.n(J),Z=Object(c.a)((function(e){return{container:{display:"flex",flexWrap:"wrap",padding:0,paddingBottom:20},textField:{width:"100%"}}})),ee={componentRestrictions:{country:"au"}};function te(e){var t=e.address,a=e.changeAddr,n=Z();return l.a.createElement(X.a,{value:t,onChange:a,onSelect:a,searchOptions:ee},(function(e){var t=e.getInputProps,a=e.suggestions,r=e.getSuggestionItemProps,i=e.loading;return l.a.createElement(m.a,{className:n.container},l.a.createElement(L.a,{className:n.textField},l.a.createElement(G.a,{htmlFor:"input-with-icon-adornment"},"Enter booking location"),l.a.createElement($.a,Object.assign({},t({placeholder:"Booking location ..."}),{startAdornment:l.a.createElement(K.a,{position:"start"},l.a.createElement(q.a,null))}))),l.a.createElement("div",null,i&&l.a.createElement("div",null,"Loading..."),a.map((function(e){var t=e.active?"suggestion-item--active":"suggestion-item",a=e.active?{backgroundColor:"#f0e0e0",cursor:"pointer"}:{backgroundColor:"white",cursor:"pointer"};return l.a.createElement("div",r(e,{className:t,style:a}),e.description)}))))}))}var ae=a(16),ne=a(79),re=a.n(ne),ie=Object(c.a)((function(e){return{flex:{display:"flex"},grow:{flexGrow:1}}}));function oe(){return l.a.createElement(p.a,{elevation:6,severity:"info",variant:"outlined",style:{marginTop:10}},"Appointments between 8am to 6pm can be booked online, at least 24 hours in advance.")}var le=function(e){var t=e.theme,a=e.services,n=e.itemQty,r=e.onSubmit,c=e.organic,p=e.pensionerRate,k=e.bookingDate,v=e.bookingAddr,h=e.toggleOrganic,O=e.togglePensionerRate,j=e.submitBooking,w=e.getAvailArtist,x=e.changeSelectedArtist,S=e.artistBooking,B=e.newBooking,C=e.setManageState,_=ie(),A=a.items,P=a.cats,N=Object(o.useState)(k),D=Object(i.a)(N,2),F=D[0],I=D[1],M=Object(o.useState)(v),T=Object(i.a)(M,2),z=T[0],Q=T[1];Object(o.useEffect)((function(){I(k),Q(v)}),[v,k]);var Y=function(e){I(e)},R=function(){for(var e=0,t=0,a=Object.keys(n);t<a.length;t++){var r=a[t],i=n[r];e+=A[r].timeOnsite*i}return F.getTime()+60*e*1e3},H=function(){var e=!0;return Object.keys(n).forEach((function(t){e=A[t].addOn&&e})),p&&1!==F.getDay()?(alert("Sorry, pensioner rate is only available on Mondays."),!1):e?(alert("Sorry, add-on services* can not be booked on its own."),!1):!(!S&&!function(){var e=new Date,t=(F-e)/36e5>=24,a=F.getHours();return t&&(a>=8&&a<=18)}())||(alert("Please book appointments between 8am to 6pm at least 24 hours in advance. If you need to book outside these hours, please call xxx."),!1)};return l.a.createElement(m.a,{maxWidth:"sm",style:{paddingTop:20,paddingBottom:50}},l.a.createElement(d.a,{control:l.a.createElement(u.a,{checked:p,onChange:function(){return O()},value:"pensionerRate",color:"primary"}),label:"Monday pensioner rate (less 20%)"}),l.a.createElement(d.a,{control:l.a.createElement(u.a,{checked:c,onChange:function(){return h()},value:"organic",color:"primary"}),label:"Use organic products"}),P.map((function(e){return l.a.createElement(W,{theme:t,items:A,key:e.name,cat:e,organic:c,pensioner:p,artistBooking:S})})),S?null:l.a.createElement(oe,null),l.a.createElement(f.a,{utils:b.a},l.a.createElement(g.a,{container:!0,justify:"space-between"},l.a.createElement(E.a,{disableToolbar:!0,variant:"inline",format:"dd/MM/yyyy",margin:"normal",id:"date-picker-inline",label:"Select booking date",value:F,onChange:Y,KeyboardButtonProps:{"aria-label":"change date"}}),l.a.createElement(y.a,{margin:"normal",id:"time-picker",label:"Select booking time",value:F,onChange:Y,KeyboardButtonProps:{"aria-label":"change time"}}))),l.a.createElement(te,{address:z,changeAddr:function(e){Q(e)}}),l.a.createElement("div",{className:_.flex},!B&&l.a.createElement(s.a,{variant:"text",color:"primary",onClick:function(){C("Default")}},"Cancel"),l.a.createElement("div",{className:_.grow}),l.a.createElement(s.a,{variant:"text",color:"primary",onClick:S?function(e){H()&&(j(F,new Date(R()),z),r(1))}:function(e){if(H()){j(F,new Date(R()),z);var t=ae.d+"?date="+re()(F).format("YYYY-MM-DD")+"&start_time="+re()(F).format("HH:mm")+"&services="+Object.keys(n)+"&quantities="+Object.values(n)+"&event_addr="+z;w(t),x(0),r(1)}},size:"large",disabled:function(){for(var e=0,t=0,a=Object.keys(n);t<a.length;t++){var r=a[t];e+=n[r]}return!(e>0&&z&&F)}()},S?"Next":"Submit")))};t.a=Object(n.b)((function(e){return{organic:e.priceFactors.organic,pensionerRate:e.priceFactors.pensionerRate,bookingDate:e.bookingDateAddr.bookingDate,bookingAddr:e.bookingDateAddr.bookingAddr,itemQty:e.itemQty}}),(function(e){return{toggleOrganic:function(){return e(Object(r.P)())},togglePensionerRate:function(){return e(Object(r.Q)())},submitBooking:function(t,a,n){return e(Object(r.O)(t,a,n))},getAvailArtist:function(t){return e(Object(r.D)(t))},changeSelectedArtist:function(t){return e(Object(r.B)(t))}}}))(le)},478:function(e,t,a){"use strict";a.r(t);var n=a(26),r=a(0),i=a.n(r),o=a(54),l=a(310),c=a(500),s=a(485),m=a(498),d=a(30),u=a(362);function g(e){var t=e.activeStep,a=function(e){return e?["Select service","Add people","Payment"]:["Select service","Add people","Payment or Update"]}(e.newBooking);return i.a.createElement(u.a,{maxWidth:"md",style:{paddingTop:20}},i.a.createElement(c.a,{activeStep:t,alternativeLabel:!0},a.map((function(e){return i.a.createElement(s.a,{key:e},i.a.createElement(m.a,null,e))}))),i.a.createElement(d.a,{variant:"h6",align:"center",gutterBottom:!0},function(e){switch(e){case 0:return"Select service items, time and location";case 1:return"Add artists and client to the booking";case 2:return"Payment";default:return"Unknown stepIndex"}}(t)))}var p=a(32),b=a(8),f=a(6),E=a(79),y=a.n(E),k=a(83),v=a(29),h=a(155),O=a(486),j=a(487),w=a(491),x=a(489),S=a(488),B=a(269),C=a(322),_=a.n(C),A=a(133),P=a(135),N=Object(v.a)((function(e){return{paper:{padding:e.spacing(3),color:e.palette.text.secondary,background:"linear-gradient(#f0e8e8, #e0d8d8)",width:"100%",overflowX:"auto"},flex:{display:"flex",marginTop:10},grow:{flexGrow:1},background:{backgroundColor:e.palette.primary.main},priceField:Object(n.a)({display:"none"},e.breakpoints.up("sm"),{display:"inline"}),priceEmbedded:Object(n.a)({display:"inline"},e.breakpoints.up("sm"),{display:"none"}),acknowledge:{display:"flex",marginTop:20,alignItems:"flexStart"},inline:{display:"inline",paddingTop:0}}}));var D=function(e){var t=e.saveBooking,a=e.assignedArtists,n=e.clientInfo,o=e.assignArtists,l=e.assignClient,c=e.bookingDate,s=e.bookingEnd,m=e.bookingAddr,g=e.items,p=e.itemQty,b=e.changeBookingStage,E=e.organic,v=e.pensioner,C=e.bookingValue,D=e.depositPayable,F=e.newBooking,I=e.artists,M=Object(r.useState)(a.map((function(e){return I[e]}))),T=Object(f.a)(M,2),z=T[0],Q=T[1],Y=N(),R=Object(r.useState)(!0),H=Object(f.a)(R,2),U=H[0],W=H[1],L=Object(r.useState)(n.client),$=Object(f.a)(L,2),G=$[0],K=$[1];Object(r.useEffect)((function(){z.length>0?W(!1):W(!0)}),[z]);var V=Object.keys(p);return i.a.createElement(u.a,{maxWidth:"sm",style:{paddingTop:20,paddingBottom:50}},i.a.createElement(h.a,{className:Y.paper},i.a.createElement(d.a,{variant:"subtitle1",align:"center",color:"textPrimary"},y()(c).format("dddd, Do MMMM YYYY")),i.a.createElement(d.a,{variant:"subtitle1",align:"center",color:"textPrimary",gutterBottom:!0},"".concat(y()(c).format("LT")," \u2013 ").concat(y()(s).format("LT"))),i.a.createElement(O.a,{size:"small","aria-label":"a dense table"},i.a.createElement(j.a,{className:Y.background},i.a.createElement(S.a,null,i.a.createElement(x.a,{align:"left",style:{width:"70%"}},i.a.createElement("b",null,"Booking location")))),i.a.createElement(w.a,null,i.a.createElement(S.a,null,i.a.createElement(x.a,{align:"left"},m)))),i.a.createElement("br",null),i.a.createElement(A.a,{artists:I,multiArtists:!0,clearable:!0,setTags:Q,tags:z,label:"Add artists"}),i.a.createElement("br",null),i.a.createElement(P.a,{setClient:K,client:G,label:"Add client"}),i.a.createElement("br",null),i.a.createElement(O.a,{size:"small","aria-label":"a dense table"},i.a.createElement(j.a,{className:Y.background},i.a.createElement(S.a,null,i.a.createElement(x.a,{align:"left",style:{width:"70%"}},i.a.createElement("b",null,"Services requested")),i.a.createElement(x.a,{align:"right",style:{width:"20%",padding:0}},i.a.createElement("div",{className:Y.priceField},i.a.createElement("b",null,"Unit price"))),i.a.createElement(x.a,{align:"right",style:{width:"10%"}},i.a.createElement("b",null,"Qty")))),i.a.createElement(w.a,null,V.map((function(e){return i.a.createElement(S.a,{key:e},i.a.createElement(x.a,{align:"left",style:{width:"70%"}},g[e].description,i.a.createElement("div",{className:Y.priceEmbedded}," - $".concat(((E?g[e].organicPrice:g[e].price)*(v?.8:1)).toFixed(2)))),i.a.createElement(x.a,{align:"right",style:{width:"20%",padding:0}},i.a.createElement("div",{className:Y.priceField},"$".concat(((E?g[e].organicPrice:g[e].price)*(v?.8:1)).toFixed(2)))),i.a.createElement(x.a,{align:"right",style:{width:"10%"}},p[e]))})))),v?i.a.createElement(B.a,{deleteIcon:i.a.createElement(_.a,null),onDelete:function(){},label:"Monday pensioner rate",color:"primary",size:"small"}):null,E?i.a.createElement(B.a,{deleteIcon:i.a.createElement(_.a,null),onDelete:function(){},label:"Use organic products",color:"primary",size:"small"}):null,i.a.createElement("hr",null),i.a.createElement(d.a,{variant:"subtitle2",align:"right",color:"textPrimary"},"TOTAL (GST INCL): $".concat(C))),i.a.createElement("div",{className:Y.flex},i.a.createElement(k.a,{variant:"text",color:"primary",size:"large",onClick:function(){o(z.map((function(e){return Number(e.id)}))),l(G),b(0)}},"back"),i.a.createElement("div",{className:Y.grow}),i.a.createElement(k.a,{variant:"text",color:"primary",size:"large",onClick:function(){o(z.map((function(e){return Number(e.id)}))),l(G);var e=y()(c).format("HH:mm"),a={artist_id_list:z.map((function(e){return Number(e.id)})),booking_date:y()(c).format("YYYY-MM-DD"),booking_time:e,booking_end_time:y()(s).format("HH:mm"),artist_start_time:e,booking_id:F?null:n.bookingId,created_datetime:null,event_address:m,quantities:Object.values(p),services:Object.keys(p).map((function(e){return Number(e)})),unit_prices:Object.keys(p).map((function(e){return g[e].price})),time_on_site:(s-c)/1e3/60,travel_distance:0,travel_duration:0,client_id:G.id,with_organic:E?1:0,with_pensioner_rate:v?1:0,paid_balance_total:null,paid_deposit_total:null,total_amount:C,paid_amount:F?D:C-n.paid,paid_type:F?"deposit":"balance",comment:"",status:""};t(a),b(2)},disabled:U},"confirm booking")))},F=Object(p.b)((function(e){return{assignedArtists:e.assignedArtists,bookingDate:e.bookingDateAddr.bookingDate,bookingEnd:e.bookingDateAddr.bookingEnd,bookingAddr:e.bookingDateAddr.bookingAddr,itemQty:e.itemQty,organic:e.priceFactors.organic,pensioner:e.priceFactors.pensionerRate,clientInfo:e.clientInfo}}),(function(e){return{assignArtists:function(t){return e(Object(b.y)(t))},assignClient:function(t){return e(Object(b.z)(t))},saveBooking:function(t){return e(Object(b.H)(t))}}}))(D),I=a(12),M=a.n(I),T=a(18),z=a(299),Q=a(99),Y=a(16),R=Object(v.a)((function(e){return{paper:{padding:e.spacing(3),color:e.palette.text.secondary,background:"linear-gradient(#f0e8e8, #e0d8d8)",width:"100%",overflowX:"auto"},textField:{width:"100%",marginTop:30},flex:{display:"flex",marginTop:10},container:{display:"flex"},grow:{flexGrow:1}}}));var H=function(e){e.theme;var t=e.changeBookingStage,a=e.depositPayable,n=e.resetBooking,o=e.addBooking,l=e.updateBooking,c=e.bookingData,s=e.newBooking,m=e.manageState,g=e.setManageState,p=e.comment,b=Object(r.useState)(p),E=Object(f.a)(b,2),y=E[0],v=E[1],O=s||c.paid_amount>0,j=R(),w=function(e){alert("".concat(e," successful!")),n()};return i.a.createElement(u.a,{maxWidth:"sm",style:{paddingTop:20,paddingBottom:20}},i.a.createElement(h.a,{className:j.paper},s?i.a.createElement(d.a,{variant:"body1",align:"left",color:"textPrimary",gutterBottom:!0},"Deposit payable: $ ",a.toString()):i.a.createElement(d.a,{variant:"body1",align:"left",color:"textPrimary",gutterBottom:!0},"Balance payable: $ ",c.paid_amount.toString()),O&&i.a.createElement(z.a,{stripePublicKey:"pk_test_a0vfdte94kBhPrDqosS5OnPd00A0fS0egz",handleCharge:function(e){return M.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.a.awrap(fetch(Y.l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,description:"client_id ".concat(c.client_id," ").concat(s?"deposit":"balance"," for booking on ").concat(c.booking_date),amount:(100*c.paid_amount).toFixed(0)})}));case 2:t.sent.ok?s?o(Object(T.a)({},c,{comment:y}),(function(){return w("Booking")})):l(Object(T.a)({},c,{comment:y}),(function(){return w("Checkout")})):alert("Stripe error. Please call to resolve this issue.");case 4:case"end":return t.stop()}}))},loggedIn:!0,payMessage:"Client Pay"}),!s&&O&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:j.container},i.a.createElement("div",{className:j.grow}),i.a.createElement("p",null,"OR"),i.a.createElement("div",{className:j.grow})),i.a.createElement(k.a,{variant:"contained",onClick:function(){l(Object(T.a)({},c,{paid_type:"cash",comment:y}),(function(){return w("Checkout")}))},color:"primary",fullWidth:!0},"Cash Pay")),i.a.createElement(Q.a,{id:"outlined-textarea",label:"Additional instructions",placeholder:"Any allergies, preferences, entrances, or any details about the room number if the client is staying in a hotel.",multiline:!0,value:y,className:j.textField,margin:"normal",variant:"outlined",onChange:function(e){v(e.target.value)}})),i.a.createElement("div",{className:j.flex},"Checkout"===m?i.a.createElement(k.a,{variant:"text",color:"primary",size:"large",onClick:function(){return g("Default")}},"Cancel"):i.a.createElement(k.a,{variant:"text",color:"primary",size:"large",onClick:function(){return t(1)}},"back"),i.a.createElement("div",{className:j.grow}),!s&&"Checkout"!==m&&O&&i.a.createElement(k.a,{variant:"text",color:"primary",size:"large",onClick:function(){l(Object(T.a)({},c,{paid_amount:0,paid_type:"none",comment:y}),(function(){return w("Update")}))}},"Update Booking")))},U=Object(p.b)((function(e){return{bookingData:e.storeActivation.bookingData,comment:e.clientInfo.comment}}),(function(e){return{resetBooking:function(){return e(Object(b.G)())},addBooking:function(t,a){return e(Object(b.x)(t,a))},updateBooking:function(t,a){return e(Object(b.R)(t,a))}}}))(H);t.default=Object(o.f)((function(e){var t,a=e.bookingStage,o=e.changeBookingStage,c=e.resetBooking,s=e.services,m=e.theme,d=e.bookingValue,u=e.depositPayable,p=e.artists,b=e.newBooking,f=e.manageState,E=e.setManageState;return Object(r.useEffect)((function(){b&&c()}),[]),i.a.createElement(i.a.Fragment,null,"Checkout"===f?null:i.a.createElement(g,{activeStep:a,newBooking:b}),0===a?i.a.createElement(l.a,{onSubmit:o,services:s,theme:m,artistBooking:!0,newBooking:b,setManageState:E}):null,1===a?i.a.createElement(F,{changeBookingStage:o,theme:m,items:s.items,bookingValue:d,depositPayable:u,newBooking:b,artists:p}):null,2===a?i.a.createElement(U,(t={changeBookingStage:o,theme:m,items:s.items,bookingValue:d,depositPayable:u},Object(n.a)(t,"bookingValue",d),Object(n.a)(t,"newBooking",b),Object(n.a)(t,"manageState",f),Object(n.a)(t,"setManageState",E),t)):null)}))}}]);
//# sourceMappingURL=1.5462e626.chunk.js.map