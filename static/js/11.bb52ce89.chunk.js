(this.webpackJsonphotm=this.webpackJsonphotm||[]).push([[11],{289:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(15),r=a.n(n),i=a(6),o=a(0),l=a.n(o),c=a(29),s=a(83),m=a(325),d=Object(c.a)((function(){return{stripe:{marginTop:20,marginBottom:20}}}));var u=Object(m.injectStripe)((function(e){var t=e.loggedIn,a=e.stripe,n=e.handleCharge,c=e.payMessage,u=Object(o.useState)(""),g=Object(i.a)(u,2),p=g[0],b=g[1],f=d();return l.a.createElement("div",{className:f.stripe},l.a.createElement("form",{onSubmit:function(e){var t;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.preventDefault(),!a){i.next=8;break}return i.next=4,r.a.awrap(a.createToken());case 4:(t=i.sent).token?n(t.token):alert("Payment token creation failed"),i.next=9;break;case 8:console.log("Stripe.js hasn't loaded yet.");case 9:case"end":return i.stop()}}))}},l.a.createElement("label",null,"Card details",l.a.createElement(m.CardElement,Object.assign({onChange:function(e){var t=e.error;t&&b(t.message)}},{hidePostalCode:!0,style:{base:{letterSpacing:"0.025em","::placeholder":{color:"#aab7c4"}},invalid:{color:"#c23d4b"}}}))),l.a.createElement("div",{className:f.stripe,role:"alert"},p),l.a.createElement(s.a,{variant:"contained",color:"primary",fullWidth:!0,type:"submit",disabled:!t},c)))}));function g(e){var t=e.stripePublicKey,a=e.handleCharge,n=e.loggedIn,r=e.payMessage;return l.a.createElement(m.StripeProvider,{apiKey:t},l.a.createElement(m.Elements,null,l.a.createElement(u,{handleCharge:a,loggedIn:n,payMessage:r})))}},295:function(e,t,a){"use strict";var n=a(32),r=a(8),i=a(6),o=a(0),l=a.n(o),c=a(29),s=a(83),m=a(431),d=a(655),u=a(656),g=a(256),p=a(115),b=a(20),f=a(258),E=a(662),y=a(25),k=a(648),v=a(649),h=a(653),O=a(651),j=a(650),w=a(154),x=a(156),S=a(317),B=a.n(S),C=a(316),A=a.n(C),_=a(318),N=a.n(_),P=a(319),D=a.n(P),F=a(103),M=a.n(F),I=a(320),T=a.n(I),z=a(321),Q=a.n(z),Y=a(654),R=a(652),U=Object(c.a)((function(e){return{paper:{width:"100%",overflowX:"auto"},background:{backgroundColor:e.palette.primary.main},priceField:Object(y.a)({display:"none"},e.breakpoints.up("sm"),{display:"inline"}),priceEmbedded:Object(y.a)({display:"inline"},e.breakpoints.up("sm"),{display:"none"})}}));var H=Object(n.b)((function(e){return{itemQty:e.itemQty}}),(function(e){return{incItemQty:function(t){return e(Object(r.E)(t))},decItemQty:function(t){return e(Object(r.C)(t))}}}))((function(e){var t=e.theme,a=e.items,n=e.cat,r=e.organic,c=e.pensioner,m=e.itemQty,d=e.incItemQty,u=e.decItemQty,g=e.artistBooking,p=U(t),b=Object(o.useState)(!1),f=Object(i.a)(b,2),E=f[0],y=f[1];return l.a.createElement(w.a,{className:p.paper},l.a.createElement(k.a,{size:"small","aria-label":"a dense table"},l.a.createElement(v.a,{className:p.background},l.a.createElement(j.a,null,l.a.createElement(O.a,{align:"left",style:{width:"60%"}},n.name.toUpperCase(),l.a.createElement(x.a,{onClick:function(e){y(!E)},edge:"start"},E?l.a.createElement(A.a,null):l.a.createElement(B.a,null))),l.a.createElement(O.a,{align:"right",style:{width:"30%",padding:0}},l.a.createElement("div",{className:p.priceField},l.a.createElement(N.a,{fontSize:"small",color:"inherit"}))),l.a.createElement(O.a,{align:"right",style:{width:"10%"}},l.a.createElement(x.a,{color:"inherit"},l.a.createElement(R.a,{badgeContent:function(e,t){var a=0,n=!0,r=!1,i=void 0;try{for(var o,l=e.list[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var c=o.value;a+=t[c]?t[c]:0}}catch(s){r=!0,i=s}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return a}(n,m),showZero:!0},l.a.createElement(D.a,null)))))),E?l.a.createElement(h.a,null,n.list.map((function(e){return l.a.createElement(j.a,{key:e},l.a.createElement(O.a,{align:"left",style:{width:"60%"}},a[e].description+(a[e].addOn?"*":""),l.a.createElement("div",{className:p.priceEmbedded}," - $"+((r?a[e].organicPrice:a[e].price)*(c?.8:1)).toFixed(2))),l.a.createElement(O.a,{align:"right",style:{width:"30%",padding:0}},l.a.createElement("div",{className:p.priceField},((r?a[e].organicPrice:a[e].price)*(c?.8:1)).toFixed(2))),a[e].onlineBooking||g?l.a.createElement(O.a,{align:"right",style:{width:"10%"}},l.a.createElement(Y.a,null,l.a.createElement(s.a,{variant:"text",startIcon:l.a.createElement(M.a,{fontSize:"small"}),onClick:function(){return d(e)}},m[e]?m[e]:0),l.a.createElement(x.a,{onClick:function(){return u(e)}},l.a.createElement(T.a,{fontSize:"small"})))):l.a.createElement(O.a,{align:"center",style:{width:"10%"}},l.a.createElement(Q.a,null)))}))):null))})),W=a(254),L=a(253),$=a(267),G=a(210),K=a(323),V=a.n(K),q=a(322),J=a.n(q),X=Object(c.a)((function(e){return{container:{display:"flex",flexWrap:"wrap",padding:0,paddingBottom:20},textField:{width:"100%"}}})),Z={componentRestrictions:{country:"au"}};function ee(e){var t=e.address,a=e.changeAddr,n=X();return l.a.createElement(J.a,{value:t,onChange:a,onSelect:a,searchOptions:Z},(function(e){var t=e.getInputProps,a=e.suggestions,r=e.getSuggestionItemProps,i=e.loading;return l.a.createElement(m.a,{className:n.container},l.a.createElement(W.a,{className:n.textField},l.a.createElement($.a,{htmlFor:"input-with-icon-adornment"},"Enter booking location"),l.a.createElement(L.a,Object.assign({},t({placeholder:"Booking location ..."}),{startAdornment:l.a.createElement(G.a,{position:"start"},l.a.createElement(V.a,null))}))),l.a.createElement("div",null,i&&l.a.createElement("div",null,"Loading..."),a.map((function(e){var t=e.active?"suggestion-item--active":"suggestion-item",a=e.active?{backgroundColor:"#f0e0e0",cursor:"pointer"}:{backgroundColor:"white",cursor:"pointer"};return l.a.createElement("div",r(e,{className:t,style:a}),e.description)}))))}))}var te=a(16),ae=a(78),ne=a.n(ae),re=Object(c.a)((function(e){return{flex:{display:"flex"},grow:{flexGrow:1}}})),ie=function(e){var t=e.theme,a=e.services,n=e.itemQty,r=e.onSubmit,c=e.organic,y=e.pensionerRate,k=e.bookingDate,v=e.bookingAddr,h=e.toggleOrganic,O=e.togglePensionerRate,j=e.submitBooking,w=e.getAvailArtist,x=e.changeSelectedArtist,S=e.artistBooking,B=e.newBooking,C=e.setManageState,A=re(),_=a.items,N=a.cats,P=Object(o.useState)(k),D=Object(i.a)(P,2),F=D[0],M=D[1],I=Object(o.useState)(v),T=Object(i.a)(I,2),z=T[0],Q=T[1];Object(o.useEffect)((function(){M(k),Q(v)}),[v,k]);var Y=function(e){M(e)},R=function(){for(var e=0,t=0,a=Object.keys(n);t<a.length;t++){var r=a[t],i=n[r];e+=_[r].timeOnsite*i}return F.getTime()+60*e*1e3},U=function(){var e=!0;return Object.keys(n).forEach((function(t){e=_[t].addOn&&e})),y&&1!==F.getDay()?(alert("Sorry, pensioner rate is only available on Mondays."),!1):!e||(alert("Sorry, add-on services* can not be booked on its own."),!1)};return l.a.createElement(m.a,{maxWidth:"sm",style:{paddingTop:20,paddingBottom:50}},l.a.createElement(d.a,{control:l.a.createElement(u.a,{checked:y,onChange:function(){return O()},value:"pensionerRate",color:"primary"}),label:"Monday pensioner rate (less 20%)"}),l.a.createElement(d.a,{control:l.a.createElement(u.a,{checked:c,onChange:function(){return h()},value:"organic",color:"primary"}),label:"Use organic products"}),N.map((function(e){return l.a.createElement(H,{theme:t,items:_,key:e.name,cat:e,organic:c,pensioner:y,artistBooking:S})})),l.a.createElement(b.a,{utils:p.a},l.a.createElement(g.a,{container:!0,justify:"space-between"},l.a.createElement(f.a,{disableToolbar:!0,variant:"inline",format:"dd/MM/yyyy",margin:"normal",id:"date-picker-inline",label:"Select booking date",value:F,onChange:Y,KeyboardButtonProps:{"aria-label":"change date"}}),l.a.createElement(E.a,{margin:"normal",id:"time-picker",label:"Select booking time",value:F,onChange:Y,KeyboardButtonProps:{"aria-label":"change time"}}))),l.a.createElement(ee,{address:z,changeAddr:function(e){Q(e)}}),l.a.createElement("div",{className:A.flex},!B&&l.a.createElement(s.a,{variant:"text",color:"primary",onClick:function(){C("Default")}},"Cancel"),l.a.createElement("div",{className:A.grow}),l.a.createElement(s.a,{variant:"text",color:"primary",onClick:S?function(e){U()&&(j(F,new Date(R()),z),r(1))}:function(e){if(U()){j(F,new Date(R()),z);var t=te.d+"?date="+ne()(F).format("YYYY-MM-DD")+"&start_time="+ne()(F).format("HH:mm")+"&services="+Object.keys(n)+"&quantities="+Object.values(n)+"&event_addr="+z;w(t),x(0),r(1)}},size:"large",disabled:function(){for(var e=0,t=0,a=Object.keys(n);t<a.length;t++){var r=a[t];e+=n[r]}return!(e>0&&z&&F)}()},S?"Next":"Submit")))};t.a=Object(n.b)((function(e){return{organic:e.priceFactors.organic,pensionerRate:e.priceFactors.pensionerRate,bookingDate:e.bookingDateAddr.bookingDate,bookingAddr:e.bookingDateAddr.bookingAddr,itemQty:e.itemQty}}),(function(e){return{toggleOrganic:function(){return e(Object(r.P)())},togglePensionerRate:function(){return e(Object(r.Q)())},submitBooking:function(t,a,n){return e(Object(r.O)(t,a,n))},getAvailArtist:function(t){return e(Object(r.D)(t))},changeSelectedArtist:function(t){return e(Object(r.B)(t))}}}))(ie)},425:function(e,t,a){"use strict";a.r(t);var n=a(25),r=a(0),i=a.n(r),o=a(54),l=a(295),c=a(661),s=a(647),m=a(659),d=a(30),u=a(431);function g(e){var t=e.activeStep,a=function(e){return e?["Select service","Add people","Payment"]:["Select service","Add people","Payment or Update"]}(e.newBooking);return i.a.createElement(u.a,{maxWidth:"md",style:{paddingTop:20}},i.a.createElement(c.a,{activeStep:t,alternativeLabel:!0},a.map((function(e){return i.a.createElement(s.a,{key:e},i.a.createElement(m.a,null,e))}))),i.a.createElement(d.a,{variant:"h6",align:"center",gutterBottom:!0},function(e){switch(e){case 0:return"Select service items, time and location";case 1:return"Add artists and client to the booking";case 2:return"Payment";default:return"Unknown stepIndex"}}(t)))}var p=a(32),b=a(8),f=a(6),E=a(78),y=a.n(E),k=a(83),v=a(29),h=a(154),O=a(648),j=a(649),w=a(653),x=a(651),S=a(650),B=a(268),C=a(324),A=a.n(C),_=a(118),N=a(120),P=Object(v.a)((function(e){return{paper:{padding:e.spacing(3),color:e.palette.text.secondary,background:"linear-gradient(#f0e8e8, #e0d8d8)",width:"100%",overflowX:"auto"},flex:{display:"flex",marginTop:10},grow:{flexGrow:1},background:{backgroundColor:e.palette.primary.main},priceField:Object(n.a)({display:"none"},e.breakpoints.up("sm"),{display:"inline"}),priceEmbedded:Object(n.a)({display:"inline"},e.breakpoints.up("sm"),{display:"none"}),acknowledge:{display:"flex",marginTop:20,alignItems:"flexStart"},inline:{display:"inline",paddingTop:0}}}));var D=function(e){var t=e.saveBooking,a=e.assignedArtists,o=e.clientInfo,l=e.assignArtists,c=e.assignClient,s=e.bookingDate,m=e.bookingEnd,g=e.bookingAddr,p=e.items,b=e.itemQty,E=e.changeBookingStage,v=e.organic,C=e.pensioner,D=e.bookingValue,F=e.depositPayable,M=e.newBooking,I=e.artists,T=Object(r.useState)(a.map((function(e){return I[e]}))),z=Object(f.a)(T,2),Q=z[0],Y=z[1],R=P(),U=Object(r.useState)(!0),H=Object(f.a)(U,2),W=H[0],L=H[1],$=Object(r.useState)(o.client),G=Object(f.a)($,2),K=G[0],V=G[1];Object(r.useEffect)((function(){Q.length>0?L(!1):L(!0)}),[Q]);var q=Object.keys(b);return i.a.createElement(u.a,{maxWidth:"sm",style:{paddingTop:20,paddingBottom:50}},i.a.createElement(h.a,{className:R.paper},i.a.createElement(d.a,{variant:"subtitle1",align:"center",color:"textPrimary"},y()(s).format("dddd, Do MMMM YYYY")),i.a.createElement(d.a,{variant:"subtitle1",align:"center",color:"textPrimary",gutterBottom:!0},y()(s).format("LT")+" \u2013 "+y()(m).format("LT")),i.a.createElement(O.a,{size:"small","aria-label":"a dense table"},i.a.createElement(j.a,{className:R.background},i.a.createElement(S.a,null,i.a.createElement(x.a,{align:"left",style:{width:"70%"}},i.a.createElement("b",null,"Booking location")))),i.a.createElement(w.a,null,i.a.createElement(S.a,null,i.a.createElement(x.a,{align:"left"},g)))),i.a.createElement("br",null),i.a.createElement(_.a,{artists:I,multiArtists:!0,clearable:!0,setTags:Y,tags:Q,label:"Add artists"}),i.a.createElement("br",null),i.a.createElement(N.a,{setClient:V,client:K,label:"Add client"}),i.a.createElement("br",null),i.a.createElement(O.a,{size:"small","aria-label":"a dense table"},i.a.createElement(j.a,{className:R.background},i.a.createElement(S.a,null,i.a.createElement(x.a,{align:"left",style:{width:"70%"}},i.a.createElement("b",null,"Services requested")),i.a.createElement(x.a,{align:"right",style:{width:"20%",padding:0}},i.a.createElement("div",{className:R.priceField},i.a.createElement("b",null,"Unit price"))),i.a.createElement(x.a,{align:"right",style:{width:"10%"}},i.a.createElement("b",null,"Qty")))),i.a.createElement(w.a,null,q.map((function(e){return i.a.createElement(S.a,{key:e},i.a.createElement(x.a,{align:"left",style:{width:"70%"}},p[e].description,i.a.createElement("div",{className:R.priceEmbedded}," - $"+((v?p[e].organicPrice:p[e].price)*(C?.8:1)).toFixed(2))),i.a.createElement(x.a,{align:"right",style:{width:"20%",padding:0}},i.a.createElement("div",{className:R.priceField},"$"+((v?p[e].organicPrice:p[e].price)*(C?.8:1)).toFixed(2))),i.a.createElement(x.a,{align:"right",style:{width:"10%"}},b[e]))})))),C?i.a.createElement(B.a,{deleteIcon:i.a.createElement(A.a,null),onDelete:function(){},label:"Monday pensioner rate",color:"primary",size:"small"}):null,v?i.a.createElement(B.a,{deleteIcon:i.a.createElement(A.a,null),onDelete:function(){},label:"Use organic products",color:"primary",size:"small"}):null,i.a.createElement("hr",null),i.a.createElement(d.a,{variant:"subtitle2",align:"right",color:"textPrimary"},"TOTAL (GST INCL): $"+D)),i.a.createElement("div",{className:R.flex},i.a.createElement(k.a,{variant:"text",color:"primary",size:"large",onClick:function(){l(Q.map((function(e){return Number(e.id)}))),c(K),E(0)}},"back"),i.a.createElement("div",{className:R.grow}),i.a.createElement(k.a,{variant:"text",color:"primary",size:"large",onClick:function(){l(Q.map((function(e){return Number(e.id)}))),c(K);var e=y()(s).format("HH:mm"),a=Object(n.a)({artist_id_list:Q.map((function(e){return Number(e.id)})),booking_date:y()(s).format("YYYY-MM-DD"),booking_time:e,booking_end_time:y()(m).format("HH:mm"),artist_start_time:e,booking_id:M?null:o.bookingId,created_datetime:null,event_address:g,quantities:Object.values(b),services:Object.keys(b).map((function(e){return Number(e)})),unit_prices:Object.keys(b).map((function(e){return p[e].price})),status:null,time_on_site:(m-s)/1e3/60,travel_distance:0,travel_duration:0,client_id:K.id,with_organic:v?1:0,with_pensioner_rate:C?1:0,paid_balance_total:null,paid_deposit_total:null,total_amount:D,paid_amount:M?F:D-o.paid,paid_type:M?"deposit":"balance",comment:""},"status","");t(a),E(2)},disabled:W},"confirm booking")))},F=(a(362),Object(p.b)((function(e){return{assignedArtists:e.assignedArtists,bookingDate:e.bookingDateAddr.bookingDate,bookingEnd:e.bookingDateAddr.bookingEnd,bookingAddr:e.bookingDateAddr.bookingAddr,itemQty:e.itemQty,organic:e.priceFactors.organic,pensioner:e.priceFactors.pensionerRate,clientInfo:e.clientInfo}}),(function(e){return{assignArtists:function(t){return e(Object(b.y)(t))},assignClient:function(t){return e(Object(b.z)(t))},saveBooking:function(t){return e(Object(b.H)(t))}}}))(D)),M=a(15),I=a.n(M),T=a(18),z=a(289),Q=a(98),Y=a(114),R=a(16),U=Object(v.a)((function(e){return{paper:{padding:e.spacing(3),color:e.palette.text.secondary,background:"linear-gradient(#f0e8e8, #e0d8d8)",width:"100%",overflowX:"auto"},textField:{width:"100%",marginTop:30},flex:{display:"flex",marginTop:10},container:{display:"flex"},grow:{flexGrow:1}}}));var H=function(e){e.theme;var t=e.changeBookingStage,a=e.depositPayable,n=e.resetBooking,o=e.addBooking,l=e.updateBooking,c=e.bookingData,s=e.newBooking,m=e.manageState,g=e.setManageState,p=e.comment,b=Object(r.useState)(p),E=Object(f.a)(b,2),y=E[0],v=E[1],O=s||c.paid_amount>0,j=U(),w=function(e){alert(e+" successful!"),n()};return i.a.createElement(u.a,{maxWidth:"sm",style:{paddingTop:20,paddingBottom:20}},i.a.createElement(h.a,{className:j.paper},s?i.a.createElement(d.a,{variant:"body1",align:"left",color:"textPrimary",gutterBottom:!0},"Deposit payable: $ ",a.toString()):i.a.createElement(d.a,{variant:"body1",align:"left",color:"textPrimary",gutterBottom:!0},"Balance payable: $ ",c.paid_amount.toString()),O&&i.a.createElement(z.a,{stripePublicKey:Y.b,handleCharge:function(e){return I.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.a.awrap(fetch(R.l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,description:s?"deposit for booking":"balance for booking",amount:(100*c.paid_amount).toFixed(0)})}));case 2:t.sent.ok?s?o(Object(T.a)({},c,{comment:y}),(function(){return w("Booking")})):l(Object(T.a)({},c,{comment:y}),(function(){return w("Checkout")})):alert("Stripe error. Please call to resolve this issue.");case 4:case"end":return t.stop()}}))},loggedIn:!0,payMessage:"Client Pay"}),!s&&O&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:j.container},i.a.createElement("div",{className:j.grow}),i.a.createElement("p",null,"OR"),i.a.createElement("div",{className:j.grow})),i.a.createElement(k.a,{variant:"contained",onClick:function(){l(Object(T.a)({},c,{paid_type:"cash",comment:y}),(function(){return w("Checkout")}))},color:"primary",fullWidth:!0},"Cash Pay")),i.a.createElement(Q.a,{id:"outlined-textarea",label:"Additional instructions",placeholder:"Any allergies, preferences, entrances, or any details about the room number if the client is staying in a hotel.",multiline:!0,value:y,className:j.textField,margin:"normal",variant:"outlined",onChange:function(e){v(e.target.value)}})),i.a.createElement("div",{className:j.flex},"Checkout"===m?i.a.createElement(k.a,{variant:"text",color:"primary",size:"large",onClick:function(){return g("Default")}},"Cancel"):i.a.createElement(k.a,{variant:"text",color:"primary",size:"large",onClick:function(){return t(1)}},"back"),i.a.createElement("div",{className:j.grow}),!s&&"Checkout"!==m&&O&&i.a.createElement(k.a,{variant:"text",color:"primary",size:"large",onClick:function(){l(Object(T.a)({},c,{paid_amount:0,paid_type:"none",comment:y}),(function(){return w("Update")}))}},"Update Booking")))},W=Object(p.b)((function(e){return{bookingData:e.storeActivation.bookingData,comment:e.clientInfo.comment}}),(function(e){return{resetBooking:function(){return e(Object(b.G)())},addBooking:function(t,a){return e(Object(b.x)(t,a))},updateBooking:function(t,a){return e(Object(b.R)(t,a))}}}))(H);t.default=Object(o.f)((function(e){var t,a=e.bookingStage,o=e.changeBookingStage,c=e.resetBooking,s=e.services,m=e.theme,d=e.bookingValue,u=e.depositPayable,p=e.artists,b=e.newBooking,f=e.manageState,E=e.setManageState;return Object(r.useEffect)((function(){b&&c()}),[]),i.a.createElement(i.a.Fragment,null,"Checkout"===f?null:i.a.createElement(g,{activeStep:a,newBooking:b}),0===a?i.a.createElement(l.a,{onSubmit:o,services:s,theme:m,artistBooking:!0,newBooking:b,setManageState:E}):null,1===a?i.a.createElement(F,{changeBookingStage:o,theme:m,items:s.items,bookingValue:d,depositPayable:u,newBooking:b,artists:p}):null,2===a?i.a.createElement(W,(t={changeBookingStage:o,theme:m,items:s.items,bookingValue:d,depositPayable:u},Object(n.a)(t,"bookingValue",d),Object(n.a)(t,"newBooking",b),Object(n.a)(t,"manageState",f),Object(n.a)(t,"setManageState",E),t)):null)}))}}]);
//# sourceMappingURL=11.bb52ce89.chunk.js.map